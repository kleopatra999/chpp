%define(repl,str,s,l,ns,%substring(0,%s,%str)%ns%substring(%[%s+%l],%str))\
%ifdef(n,,%<n=200>)\
%<data=%open(data)>\
%<cn=runaway>\
%<nums{runaway}=0>\
%<line=%"">\
%until(%eof(%data),
    %<line=%removews(%readline(%data))>\
    %if(%[%match(%"^--([a-zA-Z0-9_]+)",%line)!=-1],
        %<cn=%1>\
        %<nums{%cn}=0>\
        %ifdef(sc,,%<sc=%1>)
    ,
        %if(%line,
            %<data{%cn;%nums{%cn}}=%line>\
            %<nums{%cn}=%[%nums{%cn}+1]>
        )
    )
)\
%define(some,c,%data{%c;%[random% %nums{%c}]})\
%for(i,1,%n,
    %<cs=%some(%sc)>\
    %while(%<mp=%match(%"\\$([a-zA-Z0-9_]+)",%cs)>%[mp!=-1],
        %<cs=%repl(%cs,%mp,%strlength(%0),%some(%1))>
    )\
    %cs%"\n\n"
)\
